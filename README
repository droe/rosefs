See rose.c for documentation.

